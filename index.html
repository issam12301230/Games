<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Games Network â€” Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<style>
  :root{
    --bg:#000;
    --neon:#00ffcc;
    --neon-2:#00ffaa;
    --accent:#00ffcc;
    --muted:#88ffb3;
    --card:#0b0f10;
    --glass: rgba(255,255,255,0.03);
    --radius:12px;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:var(--bg);color:var(--neon);font-family:Tahoma,Arial,sans-serif;overflow-x:hidden}
  a{color:inherit}
  /* Loader */
  #loader{
    position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:9999;
    background:linear-gradient(180deg,rgba(0,0,0,0.95),rgba(0,0,0,0.9));
    flex-direction:column; gap:12px;
  }
  #loader .logo{font-size:28px;font-weight:800;color:var(--neon);text-shadow:0 0 18px rgba(0,255,204,0.12)}
  #loader .spinner{width:72px;height:72px;border-radius:50%;border:6px solid rgba(0,255,204,0.08);border-top-color:var(--neon);animation:spin 1s linear infinite}
  @keyframes spin{to{transform:rotate(360deg)}}

  /* matrix canvas behind everything */
  canvas#matrix{position:fixed;left:0;top:0;width:100%;height:100%;z-index:-3}

  /* top nav */
  nav{position:sticky;top:0;z-index:120;background:linear-gradient(180deg,rgba(0,0,0,0.6),rgba(0,0,0,0.35));backdrop-filter:blur(6px);display:flex;align-items:center;justify-content:space-between;padding:12px 20px;border-bottom:1px solid rgba(0,255,204,0.03)}
  .nav-left{display:flex;gap:14px;align-items:center}
  .brand{display:flex;align-items:center;gap:12px;cursor:pointer}
  .brand .logo-square{width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,var(--neon),var(--neon-2));display:flex;align-items:center;justify-content:center;font-weight:800;color:#001}
  .brand h1{margin:0;font-size:18px;color:var(--neon);text-shadow:0 0 8px rgba(0,255,204,0.08)}
  .nav-right{display:flex;gap:10px;align-items:center}
  .nav-right button{background:transparent;border:1px solid rgba(0,255,204,0.08);color:var(--neon);padding:8px 12px;border-radius:10px;cursor:pointer}
  .nav-right button:hover{box-shadow:0 0 18px var(--neon);border-color:var(--neon)}

  /* insta floating */ 
  .insta{position:fixed;left:20px;top:20px;z-index:140}
  .insta a{display:inline-flex;align-items:center;justify-content:center;width:50px;height:50px;border-radius:50%;background:linear-gradient(135deg,#ff0066,#ffcc00);color:#fff;text-decoration:none;box-shadow:0 0 18px rgba(255,0,120,0.25),0 0 30px rgba(0,255,204,0.06);transition:transform .18s}
  .insta a:hover{transform:translateY(-6px) rotate(-6deg);box-shadow:0 0 35px rgba(0,255,204,0.5)}

  /* layout */
  .container{max-width:1300px;margin:18px auto;padding:0 18px}
  main{display:grid;grid-template-columns:1fr;gap:18px}

  /* hero */
  .hero{display:flex;align-items:center;justify-content:space-between;gap:20px;padding:36px;border-radius:14px;background:linear-gradient(180deg,rgba(0,255,204,0.02),rgba(0,255,204,0.01));box-shadow:0 6px 30px rgba(0,255,204,0.03)}
  .hero .left{max-width:720px}
  .hero h2{font-size:34px;margin:0 0 10px;color:var(--neon);text-shadow:0 0 12px rgba(0,255,204,0.08)}
  .hero p{margin:0 0 16px;color:rgba(255,255,255,0.7)}
  .cta{display:inline-flex;gap:12px;align-items:center;padding:12px 18px;border-radius:12px;background:linear-gradient(90deg,var(--neon),var(--neon-2));color:#001;font-weight:800;cursor:pointer;box-shadow:0 8px 30px rgba(0,255,204,0.14)}
  .hero .right{width:360px;min-height:220px;border-radius:12px;overflow:hidden;background:linear-gradient(180deg,rgba(255,255,255,0.03),transparent);display:flex;align-items:center;justify-content:center}

  /* sections nav tabs */
  .sections-nav{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px}
  .tab{padding:8px 12px;border-radius:10px;background:rgba(0,0,0,0.5);border:1px solid rgba(0,255,204,0.04);cursor:pointer}
  .tab.active{background:linear-gradient(90deg,var(--neon),var(--neon-2));color:#001;font-weight:800;box-shadow:0 6px 30px rgba(0,255,204,0.12)}

  /* layout sections */
  .page{display:none;animation:fadeIn .4s ease;min-height:60vh;padding:18px;border-radius:12px;background:linear-gradient(180deg,rgba(0,0,0,0.22),rgba(0,0,0,0.14));box-shadow:0 8px 40px rgba(0,0,0,0.6)}
  .page.active{display:block}
  @keyframes fadeIn{from{opacity:0; transform:translateY(14px)} to{opacity:1; transform:none}}

  /* games area split */
  .games-wrap{display:grid;grid-template-columns:300px 1fr;gap:18px}
  /* sidebar filters */
  .sidebar{background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);padding:14px;border-radius:12px;border:1px solid rgba(0,255,204,0.04)}
  .filter-group{margin-bottom:12px}
  .filter-group label{display:block;color:rgba(255,255,255,0.8);margin-bottom:6px}
  .filter-group select,.filter-group input{width:100%;padding:10px;border-radius:8px;border:none;background:#071218;color:var(--neon);box-shadow:inset 0 0 8px rgba(0,255,204,0.02)}
  .checkboxes{display:flex;flex-wrap:wrap;gap:8px}
  .chip{padding:6px 10px;border-radius:999px;background:rgba(0,255,204,0.04);cursor:pointer;border:1px solid rgba(0,255,204,0.02)}

  /* game grid & card advanced */
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px}
  .card{background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);border-radius:12px;overflow:hidden;border:1px solid rgba(255,255,255,0.03);position:relative;transform-style:preserve-3d;transition:transform .35s,box-shadow .35s}
  .card:hover{transform:translateY(-10px) rotateX(4deg) rotateY(-4deg);box-shadow:0 10px 40px rgba(0,255,204,0.12)}
  .thumb{height:150px;background:#222 url('https://placehold.co/600x360?text=No') center/cover no-repeat}
  .card-body{padding:12px;display:flex;flex-direction:column;gap:8px}
  .card h3{margin:0;font-size:16px;color:#eafff5}
  .meta{display:flex;justify-content:space-between;gap:8px;align-items:center}
  .rating{display:inline-flex;gap:6px;align-items:center}
  .rating .bar{width:80px;height:8px;background:rgba(255,255,255,0.06);border-radius:6px;overflow:hidden}
  .rating .fill{height:100%;background:linear-gradient(90deg,var(--neon),var(--neon-2));width:40%}
  .platforms{display:flex;gap:6px;align-items:center}
  .plat{font-size:14px;padding:6px 8px;border-radius:8px;background:rgba(0,0,0,0.35);color:var(--neon);}

  .actions{display:flex;gap:8px;align-items:center}
  .btn-ghost{padding:8px 10px;border-radius:8px;background:transparent;border:1px solid rgba(0,255,204,0.06);color:var(--neon);cursor:pointer}
  .fav{margin-left:auto;cursor:pointer;font-size:18px}

  /* carousel (trending/new) */
  .carousel{display:flex;gap:12px;overflow:auto;padding-bottom:8px}
  .carousel::-webkit-scrollbar{height:8px}
  .carousel-card{min-width:220px;border-radius:12px;overflow:hidden;border:1px solid rgba(255,255,255,0.03);background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent)}
  .badge{position:absolute;top:10px;left:10px;background:var(--neon);color:#001;padding:6px 10px;border-radius:8px;font-weight:800}

  /* popup modal details */
  .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:linear-gradient(rgba(0,0,0,0.6),rgba(0,0,0,0.85));z-index:999}
  .modal.open{display:flex}
  .modal-card{width:min(900px,96%);background:linear-gradient(180deg,#061014, #0b1214);padding:18px;border-radius:12px;border:1px solid rgba(0,255,204,0.06);box-shadow:0 20px 60px rgba(0,0,0,0.6);color:#eafff5}
  .modal-grid{display:grid;grid-template-columns:1fr 2fr;gap:12px}
  .modal img{width:100%;height:260px;object-fit:cover;border-radius:8px}
  .close-btn{background:#111;padding:8px 12px;border-radius:8px;color:var(--neon);border:1px solid rgba(0,255,204,0.04);cursor:pointer}

  /* footer */
  footer{margin-top:18px;padding:18px;border-top:1px solid rgba(0,255,204,0.03);display:flex;justify-content:space-between;align-items:center;gap:12px}
  footer .links{display:flex;gap:12px;align-items:center}
  footer .copy{color:rgba(255,255,255,0.6)}

  /* small responsiveness */
  @media(max-width:880px){
    .games-wrap{grid-template-columns:1fr}
    .hero{flex-direction:column}
    .hero .right{width:100%}
    .insta{left:12px;top:12px}
  }
</style>
</head>
<body>

<!-- Loader -->
<div id="loader"><div class="logo">Games Network</div><div class="spinner"></div><div style="color:#aaffdd">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰â€¦</div></div>

<!-- Matrix Canvas -->
<canvas id="matrix"></canvas>

<!-- Floating Instagram -->
<div class="insta"><a href="https://instagram.com/1x_x.issam.x_x5" target="_blank" title="@1x_x.issam.x_x5">IG</a></div>

<!-- Top Nav -->
<nav>
  <div class="nav-left">
    <div class="brand" onclick="showSection('home')">
      <div class="logo-square">GN</div>
      <h1>Games Network</h1>
    </div>
    <div class="sections-nav" style="margin-left:14px">
      <div class="tab active" data-target="home" onclick="showSection('home')">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
      <div class="tab" data-target="games" onclick="showSection('games')">Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨</div>
      <div class="tab" data-target="trending" onclick="showSection('trending')">Ø§Ù„Ø£ÙƒØ«Ø± Ø´Ù‡Ø±Ø©</div>
      <div class="tab" data-target="newest" onclick="showSection('newest')">Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</div>
      <div class="tab" data-target="categories" onclick="showSection('categories')">Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</div>
      <div class="tab" data-target="about" onclick="showSection('about')">Ø­ÙˆÙ„Ù†Ø§</div>
      <div class="tab" data-target="contact" onclick="showSection('contact')">ØªÙˆØ§ØµÙ„</div>
    </div>
  </div>

  <div class="nav-right">
    <button onclick="showFavorites()">Ø§Ù„Ù…ÙØ¶Ù„Ø© (<span id="favCount">0</span>)</button>
    <button onclick="scrollTop()">â¤’</button>
  </div>
</nav>

<div class="container">
  <main>

    <!-- HERO -->
    <section class="page active" id="home">
      <div class="hero">
        <div class="left">
          <h2>Ù…Ø±Ø­Ø¨Ø§ Ø¨Ùƒ ÙÙŠ <span style="color:var(--neon-2)">Games Network</span></h2>
          <p>Ø§ÙƒØªØ´Ù Ø¢Ù„Ø§Ù Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø¹Ø¨Ø± Ù…Ù†ØµØ§Øª Ù…ØªØ¹Ø¯Ø¯Ø© â€” ØªØµÙ…ÙŠÙ… Ø£Ù†ÙŠÙ‚ØŒ ØªØ¬Ø±Ø¨Ø© Ø³Ø±ÙŠØ¹Ø© ÙˆÙ…Ù„ÙŠØ¦Ø© Ø¨Ø§Ù„Ø­ÙŠÙˆÙŠØ©.</p>
          <div style="display:flex;gap:12px;margin-top:14px">
            <div class="cta" onclick="showSection('games')">Ø§Ø³ØªÙƒØ´Ù Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„Ø¢Ù†</div>
            <div class="tab" onclick="showSection('trending')">ğŸ”¥ Ø§Ù„Ø£ÙƒØ«Ø± Ø´Ù‡Ø±Ø©</div>
            <div class="tab" onclick="showSection('newest')">âœ¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</div>
          </div>
          <div style="margin-top:18px;display:flex;gap:10px;align-items:center">
            <div style="width:100px;height:100px;border-radius:12px;background:linear-gradient(90deg,var(--neon),var(--neon-2));display:flex;align-items:center;justify-content:center;color:#001;font-weight:800">LOGO</div>
            <div style="color:rgba(255,255,255,0.7)">Ø´Ø¨ÙƒØ© Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ â€” ÙˆØ§Ø¬Ù‡Ø© Ø£Ù†ÙŠÙ‚Ø©ØŒ Ù…Ø­ØªÙˆÙ‰ Ù…ØªØ¬Ø¯Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.</div>
          </div>
        </div>
        <div class="right">
          <!-- rotating highlights area -->
          <img id="heroPreview" src="https://placehold.co/600x360?text=Games+Network" alt="preview" style="width:100%;height:100%;object-fit:cover" />
        </div>
      </div>
    </section>

    <!-- GAMES -->
    <section class="page" id="games">
      <h2 style="margin-top:0">Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨</h2>
      <div class="games-wrap">
        <aside class="sidebar">
          <div class="filter-group">
            <label for="searchInput">Ø¨Ø­Ø«</label>
            <input id="searchInput" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø¹Ø¨Ø©..." oninput="applyFilters()" />
          </div>
          <div class="filter-group">
            <label>Ø§Ù„Ù…Ù†ØµØ©</label>
            <select id="platformSelect" onchange="applyFilters()">
              <option value="">ÙƒÙ„ Ø§Ù„Ù…Ù†ØµØ§Øª</option>
              <option value="pc">PC</option>
              <option value="playstation">PlayStation</option>
              <option value="xbox">Xbox</option>
              <option value="nintendo">Nintendo</option>
              <option value="android">Android</option>
            </select>
          </div>
          <div class="filter-group">
            <label>Ø§Ù„Ù†ÙˆØ¹</label>
            <div class="checkboxes" id="genreChips"></div>
          </div>
          <div style="margin-top:10px;display:flex;gap:8px">
            <button class="btn-ghost" onclick="resetFilters()">Ø¥Ø¹Ø§Ø¯Ø©</button>
            <button class="btn-ghost" onclick="randomFromAll()">Ù„Ø¹Ø¨Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©</button>
          </div>
        </aside>

        <section style="background:transparent;padding:0;border-radius:0">
          <div id="gamesGrid" class="grid"></div>
          <div style="margin-top:14px;text-align:center">
            <button class="cta" onclick="loadMoreGames()">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²ÙŠØ¯</button>
          </div>
        </section>
      </div>
    </section>

    <!-- TRENDING -->
    <section class="page" id="trending">
      <h2 style="margin-top:0">Ø§Ù„Ø£ÙƒØ«Ø± Ø´Ù‡Ø±Ø©</h2>
      <div id="trendCarousel" class="carousel"></div>
    </section>

    <!-- NEWEST -->
    <section class="page" id="newest">
      <h2 style="margin-top:0">Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</h2>
      <div id="newCarousel" class="carousel"></div>
    </section>

    <!-- CATEGORIES -->
    <section class="page" id="categories">
      <h2 style="margin-top:0">Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</h2>
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px">
        <div style="padding:18px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);text-align:center">
          <h3>PC</h3><p>Ø£Ù‚ÙˆÙ‰ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø§Ø³ÙˆØ¨</p>
        </div>
        <div style="padding:18px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);text-align:center">
          <h3>PlayStation</h3><p>Ø¥ØµØ¯Ø§Ø±Ø§Øª Ø¨Ù„Ø§ÙŠØ³ØªÙŠØ´Ù† Ø§Ù„Ø´Ù‡ÙŠØ±Ø©</p>
        </div>
        <div style="padding:18px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);text-align:center">
          <h3>Xbox</h3><p>Ø¹Ø§Ù„Ù… Ø¥ÙƒØ³ Ø¨ÙˆÙƒØ³</p>
        </div>
        <div style="padding:18px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);text-align:center">
          <h3>Nintendo</h3><p>Ø£ÙØ¶Ù„ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠØ© ÙˆØ§Ù„Ø¹Ø§Ø¦Ù„ÙŠØ©</p>
        </div>
      </div>
    </section>

    <!-- ABOUT -->
    <section class="page" id="about">
      <h2 style="margin-top:0">Ø­ÙˆÙ„ Games Network</h2>
      <p id="aboutText"></p>
    </section>

    <!-- CONTACT -->
    <section class="page" id="contact">
      <h2 style="margin-top:0">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</h2>
      <p>ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ø¹Ø¨Ø± Ø¥Ù†Ø³ØªØºØ±Ø§Ù…: <a href="https://instagram.com/1x_x.issam.x_x5" target="_blank">@1x_x.issam.x_x5</a></p>
      <form id="contactForm" onsubmit="submitContact(event)" style="display:grid;gap:10px;max-width:520px">
        <input required placeholder="Ø§Ø³Ù…Ùƒ" id="cfName" style="padding:10px;border-radius:8px;border:none;background:#071218;color:var(--neon)" />
        <input required placeholder="Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" id="cfEmail" style="padding:10px;border-radius:8px;border:none;background:#071218;color:var(--neon)" />
        <textarea required placeholder="Ø±Ø³Ø§Ù„ØªÙƒ..." id="cfMsg" rows="5" style="padding:10px;border-radius:8px;border:none;background:#071218;color:var(--neon)"></textarea>
        <div><button class="cta" type="submit">Ø¥Ø±Ø³Ø§Ù„</button></div>
      </form>
    </section>

  </main>

  <!-- Footer -->
  <footer>
    <div class="links">
      <a href="#" onclick="showSection('home')">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
      <a href="#" onclick="showSection('games')">Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨</a>
      <a href="#" onclick="showSection('contact')">ØªÙˆØ§ØµÙ„</a>
    </div>
    <div class="copy">Â© Games Network â€” Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</div>
  </footer>
</div>

<!-- Modal details -->
<div id="modal" class="modal" onclick="closeModal(event)">
  <div class="modal-card" onclick="event.stopPropagation()">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
      <h3 id="m-title"></h3>
      <div><button class="close-btn" onclick="closeModal()">Ø¥ØºÙ„Ø§Ù‚</button></div>
    </div>
    <div class="modal-grid">
      <div><img id="m-img" src=""></div>
      <div>
        <p id="m-desc" style="color:rgba(255,255,255,0.8)"></p>
        <p id="m-meta" style="color:var(--muted)"></p>
        <div style="margin-top:12px;display:flex;gap:8px;align-items:center">
          <a id="m-link" class="cta" href="#" target="_blank">Ø§Ø°Ù‡Ø¨ Ù„Ù„ØªÙØ§ØµÙŠÙ„</a>
          <button class="btn-ghost" onclick="toggleFavModal()">â˜† Ø­ÙØ¸</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
/* -------------------------
   Config and state
   ------------------------- */
const RAWG_KEY = '02fafcff858c4e7a8958fcc861a23fd8';
let page = 1;
let gamesList = [];
let favorites = JSON.parse(localStorage.getItem('gn_favs')||'[]');

/* utility */
function el(id){ return document.getElementById(id) }
function showSection(id){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  const pageEl = document.getElementById(id);
  if(pageEl){pageEl.classList.add('active');}
  // update tab active state
  document.querySelectorAll('.sections-nav .tab').forEach(t=>t.classList.remove('active'));
  document.querySelectorAll('.sections-nav .tab').forEach(t=>{ if(t.dataset.target===id) t.classList.add('active')});
  window.scrollTo({top:0,behavior:'smooth'});
}

/* play tiny UI sound */
function uiBeep(){
  try{
    const ctx = new (window.AudioContext||window.webkitAudioContext)();
    const o = ctx.createOscillator(); const g = ctx.createGain();
    o.type='sine'; o.frequency.value=880; g.gain.value=0.02; o.connect(g); g.connect(ctx.destination); o.start();
    setTimeout(()=>{ o.stop(); ctx.close(); }, 90);
  }catch(e){}
}

/* -------------------------
   Loader hide after ready
   ------------------------- */
function hideLoader(){ document.getElementById('loader').style.display='none'; }

/* -------------------------
   Matrix background
   ------------------------- */
const canvas = document.getElementById('matrix');
const ctx = canvas.getContext('2d');
function setupCanvas(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
setupCanvas();
window.addEventListener('resize', ()=>{ setupCanvas(); initMatrix(); });
const letters = '01ã‚ã„ã†ãˆãŠã‚¢ã‚¤ã‚¦ã‚¨ã‚ªABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
let fontSize = 14;
let columns = Math.floor(canvas.width / fontSize);
let drops = [];
function initMatrix(){
  fontSize = Math.max(12, Math.floor(window.innerWidth / 140));
  columns = Math.floor(canvas.width / fontSize);
  drops = Array(columns).fill(1);
}
initMatrix();
function drawMatrix(){
  ctx.fillStyle = 'rgba(0, 0, 0, 0.08)';
  ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle = '#00ff99';
  ctx.font = fontSize + 'px monospace';
  for(let i=0;i<drops.length;i++){
    const text = letters[Math.floor(Math.random()*letters.length)];
    ctx.fillText(text, i*fontSize, drops[i]*fontSize);
    if(drops[i]*fontSize > canvas.height && Math.random() > 0.975) drops[i]=0;
    drops[i]++;
  }
}
setInterval(drawMatrix, 50);

/* -------------------------
   Fetching Games (RAWG)
   ------------------------- */
async function fetchGames(reset=false){
  if(reset){ page=1; gamesList=[]; document.getElementById('gamesGrid').innerHTML=''; }
  const url = new URL('https://api.rawg.io/api/games');
  url.searchParams.set('key', RAWG_KEY);
  url.searchParams.set('page', page);
  url.searchParams.set('page_size', 20);
  // you can add ordering or filters later
  try{
    const res = await fetch(url);
    const data = await res.json();
    const results = data.results || [];
    gamesList = gamesList.concat(results);
    renderGrid(results);
    page++;
  }catch(e){
    console.error('fetch error',e);
  }finally{
    hideLoader();
    updateFavCount();
  }
}
function renderGrid(items){
  const container = document.getElementById('gamesGrid');
  items.forEach(g => {
    const rating = Math.round((g.rating||0)*10); // 0-100
    const fillW = Math.min(100, rating);
    const platforms = (g.parent_platforms||[]).map(p=>p.platform.slug);
    const pHtml = platforms.slice(0,3).map(s=>`<span class="plat">${platformEmoji(s)}</span>`).join('');
    const inFav = favorites.includes(g.id);
    const card = document.createElement('div'); card.className='card';
    card.innerHTML = `
      <div class="thumb" style="background-image:url('${g.background_image || 'https://placehold.co/600x360?text=No+Image'}');background-size:cover"></div>
      <div class="card-body">
        <h3>${escapeHtml(g.name)}</h3>
        <div class="meta">
          <div class="rating"><div class="bar"><div class="fill" style="width:${fillW}%"></div></div><div style="font-size:12px;color:var(--muted)">${g.rating||0}â˜…</div></div>
          <div class="platforms">${pHtml}</div>
        </div>
        <div style="display:flex;align-items:center;margin-top:8px">
          <button class="btn-ghost" onclick='openModal(${JSON.stringify(g.id)})'>ØªÙØ§ØµÙŠÙ„</button>
          <a class="btn-ghost" href="https://rawg.io/games/${g.slug}" target="_blank" style="margin-left:8px">ØµÙØ­Ø©</a>
          <div class="fav" title="Ø­ÙØ¸ Ø¨Ø§Ù„Ù…ÙØ¶Ù„Ø©" onclick="toggleFav(${g.id}, ${JSON.stringify(g.name)})" style="margin-inline-start:auto">${inFav?'â˜…':'â˜†'}</div>
        </div>
      </div>`;
    container.appendChild(card);
  });
}

/* small escape */
function escapeHtml(s){ return (s+'').replace(/[&<>"]/g, c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c])); }

/* platform emoji helper */
function platformEmoji(slug){
  if(!slug) return '';
  if(slug.includes('pc')) return 'ğŸ’»';
  if(slug.includes('playstation')) return 'ğŸ®';
  if(slug.includes('xbox')) return 'ğŸ•¹ï¸';
  if(slug.includes('android')||slug.includes('ios')) return 'ğŸ“±';
  if(slug.includes('nintendo')) return 'ğŸ¯';
  return 'ğŸ®';
}

/* load more */
function loadMoreGames(){ fetchGames(); uiBeep(); }

/* Apply filters (search + platform + genre) */
function applyFilters(){
  const q = document.getElementById('searchInput').value.toLowerCase().trim();
  const platform = document.getElementById('platformSelect').value;
  let filtered = gamesList.slice();
  if(q) filtered = filtered.filter(g=>g.name.toLowerCase().includes(q));
  if(platform) filtered = filtered.filter(g => (g.parent_platforms||[]).some(p=>p.platform.slug.includes(platform)));
  document.getElementById('gamesGrid').innerHTML='';
  renderGrid(filtered);
}

/* reset filters */
function resetFilters(){
  document.getElementById('searchInput').value='';
  document.getElementById('platformSelect').value='';
  document.getElementById('gamesGrid').innerHTML=''; renderGrid(gamesList); uiBeep();
}

/* favorites */
function toggleFav(id,name){
  const idx = favorites.indexOf(id);
  if(idx === -1){ favorites.push(id); } else { favorites.splice(idx,1); }
  localStorage.setItem('gn_favs', JSON.stringify(favorites));
  updateFavCount();
  // refresh view quickly
  document.getElementById('gamesGrid').innerHTML=''; renderGrid(gamesList);
  uiBeep();
}
function updateFavCount(){ el('favCount').innerText = favorites.length; }
function showFavorites(){
  if(!favorites.length){ alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù„Ø¹Ø§Ø¨ Ù…Ø­ÙÙˆØ¸Ø©'); return; }
  // fetch details for favorites (or find in gamesList)
  const favDetails = gamesList.filter(g=>favorites.includes(g.id));
  if(favDetails.length){
    document.getElementById('gamesGrid').innerHTML=''; renderGrid(favDetails);
    showSection('games');
  }else{
    alert('Ø§Ù„Ù…ÙØ¶Ù„Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© Ø§Ù„Ø¢Ù† (Ø±Ø¨Ù…Ø§ ØªØ­ØªØ§Ø¬ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²ÙŠØ¯)');
  }
}

/* modal open/close by id */
async function openModal(id){
  uiBeep();
  const modal = document.getElementById('modal');
  modal.classList.add('open');
  const card = (gamesList.find(g=>g.id===id));
  if(!card){
    // try fetch single game
    try{
      const res = await fetch(`https://api.rawg.io/api/games/${id}?key=${RAWG_KEY}`);
      const data = await res.json();
      populateModal(data);
    }catch(e){ console.error(e) }
  } else populateModal(card);
}
function populateModal(g){
  el('m-title').innerText = g.name;
  el('m-img').src = g.background_image || 'https://placehold.co/600x360?text=No+Image';
  el('m-desc').innerText = g.description_raw ? g.description_raw.slice(0,400)+'...' : (g.slug||'') ;
  el('m-meta').innerText = `Ø§Ù„Ù…Ù†ØµØ§Øª: ${(g.parent_platforms||[]).map(p=>p.platform.name).join(' â€¢ ')}\nØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±: ${g.released || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}`;
  el('m-link').href = 'https://rawg.io/games/'+(g.slug||g.id);
}
function closeModal(e){
  if(!e || e.target.classList.contains('modal') || e.target.classList.contains('close-btn')) {
    document.getElementById('modal').classList.remove('open');
  }
}
function toggleFavModal(){
  const title = el('m-title').innerText;
  // find id by title
  const g = gamesList.find(x=>x.name===title);
  if(g) toggleFav(g.id,g.name);
}

/* Trending and Newest carousels */
async function fetchTrending(){
  try{
    const res = await fetch(`https://api.rawg.io/api/games/lists/popular?key=${RAWG_KEY}&page_size=12`);
    const data = await res.json();
    renderCarousel('trendCarousel', data.results||[]);
  }catch(e){ console.error(e) }
}
async function fetchNewest(){
  try{
    const url = new URL('https://api.rawg.io/api/games');
    url.searchParams.set('key', RAWG_KEY);
    url.searchParams.set('ordering','-released');
    url.searchParams.set('page_size',12);
    const res = await fetch(url);
    const data = await res.json();
    renderCarousel('newCarousel', data.results||[]);
  }catch(e){ console.error(e) }
}
function renderCarousel(id, items){
  const c = document.getElementById(id);
  c.innerHTML = '';
  items.forEach(g=>{
    const div = document.createElement('div'); div.className='carousel-card';
    div.innerHTML = `<div style="position:relative"><div class="badge">${g.added?('ğŸ”¥'):('')}</div><img src="${g.background_image || 'https://placehold.co/600x360'}" style="width:220px;height:120px;object-fit:cover"/></div>
      <div style="padding:10px"><strong>${g.name}</strong><div style="color:var(--muted);font-size:13px;margin-top:6px">${g.released||''}</div><div style="margin-top:8px"><a class="btn-ghost" href="https://rawg.io/games/${g.slug}" target="_blank">ØªÙØ§ØµÙŠÙ„</a></div></div>`;
    c.appendChild(div);
  });
}

/* about typewriter */
const aboutText = "Games Network â€” Ù…Ù†ØµØ© ØªØ¬Ù…Ø¹ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ù…Ù† Ù…ØµØ§Ø¯Ø± Ù…ÙˆØ«ÙˆÙ‚Ø© ÙˆØªØ¹Ø±Ø¶Ù‡Ø§ Ø¨ØªØµÙ…ÙŠÙ… Ø£Ù†ÙŠÙ‚ ÙˆØ³Ù‡Ù„. ØªØµÙÙ‘Ø­ØŒ Ø§Ø­ÙØ¸ Ù…ÙØ¶Ù„Ø§ØªÙƒØŒ ÙˆØ§ÙƒØªØ´Ù Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙŠÙˆÙ…ÙŠØ§Ù‹.";
(function typeWriter(){
  const elA = document.getElementById('aboutText');
  let i=0;
  function step(){ if(i<=aboutText.length){ elA.innerText = aboutText.slice(0,i++); setTimeout(step,28) } }
  step();
})();

/* contact form (dummy) */
function submitContact(e){
  e.preventDefault();
  alert('ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø±Ø³Ø§Ù„Ø©. Ø´ÙƒØ±Ø§Ù‹ Ù„ØªÙˆØ§ØµÙ„Ùƒ!');
  document.getElementById('contactForm').reset();
}

/* random game from loaded list */
function randomFromAll(){
  if(!gamesList.length){ alert('Ø§Ù†ØªØ¸Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨'); return; }
  const g = gamesList[Math.floor(Math.random()*gamesList.length)];
  openModal(g.id);
}

/* scroll to top */
function scrollTop(){ window.scrollTo({top:0,behavior:'smooth'}); }

/* init */
(async function initAll(){
  await fetchGames();
  fetchTrending(); fetchNewest();
  // populate genres from initial results
  const genres = new Set();
  (gamesList||[]).forEach(g => (g.genres||[]).forEach(x=>genres.add(x.name)));
  const chips = document.getElementById('genreChips');
  genres.forEach(g=>{ const c=document.createElement('div'); c.className='chip'; c.innerText=g; c.onclick=()=>{document.getElementById('searchInput').value=g; applyFilters()}; chips.appendChild(c) });

  // hide loader after some time
  setTimeout(hideLoader,900);
})();

/* update favorites count initial */
updateFavCount();

/* hide loader on window load timeout fallback */
setTimeout(hideLoader,4000);
</script>

</body>
</html>
